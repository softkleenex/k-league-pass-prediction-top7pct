
================================================================================
exp_035: Train Phase1A + Selected Features Model
================================================================================

================================================================================
exp_035: Phase1A + Selected Features Trainer
================================================================================
  Baseline: Phase1A (CV 15.45 → Public 15.35)
  Strategy: Add 5 selected features valid for last passes
  Target: CV < 15.0
================================================================================

================================================================================
Step 1: Loading Feature-Engineered Data
================================================================================
  Loading: train_phase1a_plus_features.csv
    Total passes: 356,721
    Columns: 37
    Unique games: 198
    Unique episodes: 15435

================================================================================
Step 2: Preparing Features
================================================================================
  Total features available: 24

  Feature Categories:
    Phase1A: 19/19
    Selected Advanced: 5/5

  Final feature count: 24

  Checking for missing values...
  ✓ No missing values

  Checking for infinite values...
  ✓ No infinite values

  ✓ Features ready
  Feature list: ['episode_id', 'action_id', 'zone_x', 'zone_y', 'prev_dx', 'prev_dy', 'direction', 'goal_distance', 'goal_angle', 'time_left', 'game_clock_min', 'pass_count', 'is_home_encoded', 'type_encoded', 'result_encoded', 'is_final_team', 'team_possession_pct', 'team_switches', 'final_poss_len', 'ball_speed', 'distance_to_goal_line', 'distance_to_sideline', 'possession_duration', 'pressure_level']

================================================================================
Step 3: Running 3-Fold Cross-Validation
================================================================================
  X shape: (356721, 24)
  y shape: (356721, 2)
  Unique games (groups): 198

  Fold 1/3
    Train: 237,771 samples
    Val: 118,950 samples
    Training models... 28.9s
    Fold 1 Score: 10.2207

  Fold 2/3
    Train: 237,869 samples
    Val: 118,852 samples
    Training models... 28.8s
    Fold 2 Score: 10.2143

  Fold 3/3
    Train: 237,802 samples
    Val: 118,919 samples
    Training models... 28.2s
    Fold 3 Score: 10.2347

================================================================================
Cross-Validation Results
================================================================================
  CV Mean: 10.2233
  CV Std: 0.0085
  Fold scores: ['10.2207', '10.2143', '10.2347']

  Baseline (Phase1A): 15.4500
  Improvement: +5.2267

  ✅ Target achieved! (CV < 15.0)

================================================================================
Step 4: Training Final Model (All Data)
================================================================================
  Training on 356,721 samples...
  Training model_x... ✓
  Training model_y... ✓

================================================================================
Step 5: Saving Results
================================================================================
  ✓ CV results saved: cv_results.json
  ✓ Model X saved: model_x_catboost.pkl
  ✓ Model Y saved: model_y_catboost.pkl

================================================================================
Training Complete!
================================================================================
  CV: 10.2233 ± 0.0085
  Runtime: 127.5s

  Next steps:
    ✅ CV < 15.0! Generate submission:
       python predict_submission.py
================================================================================
